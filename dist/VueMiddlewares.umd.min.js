(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["VueMiddlewares"]=e():t["VueMiddlewares"]=e()})("undefined"!==typeof self?self:this,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s="fae3")}({f6fd:function(t,e){(function(t){var e="currentScript",r=t.getElementsByTagName("script");e in t||Object.defineProperty(t,e,{get:function(){try{throw new Error}catch(n){var t,e=(/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(n.stack)||[!1])[1];for(t in r)if(r[t].src==e||"interactive"==r[t].readyState)return r[t];return null}}})})(document)},fae3:function(t,e,r){"use strict";var n;(r.r(e),"undefined"!==typeof window)&&(r("f6fd"),(n=window.document.currentScript)&&(n=n.src.match(/(.+\/)[^\/]+\.js(\?.*)?$/))&&(r.p=n[1]));const i={};function o(t){if(i[t])return i[t];throw Error(`"${t}" is not registered Middleware.`)}function s(t,e){if("string"!==typeof t||!t.toString().length)throw Error("A key is required to register a global MiddleWare");return i[t]=u(e)}const a="Middleware failed to validate.";class c extends Error{constructor(t,{to:e,from:r,next:n},i,o,...s){if(!(t instanceof d))throw new Error("The first argument must be an instance of Middleware.");super(o||a,...s),this.to=e,this.from=r,this.next=n,this.response=i,this.middleware=t,Error.captureStackTrace(this,c)}}class d{constructor(t){this.validator=t}get validator(){return this.$validator}set validator(t){t instanceof Function?this.$validator=t:this.$validator=()=>!!t}validate(t,e,r){return new Promise((n,i)=>{const o=this.validator(t,e,r);o instanceof Promise?o.then(n,i):!0===o?n(this):i(new c(this,{to:t,from:e,next:r},o))})}}function u(t){return t instanceof d?t:"string"===typeof t?o(t):new d(t)}class l{constructor(t){this.items=t||[]}index(t){return this.items.indexOf(t)}contains(t){return!!this.index(t)}add(t){return this.items.push(u(t)),this}remove(t){const e=this.index(t);return this.items[e]&&this.items[e].splice(e,1),this}validate(t,e,r){const n=this.items.map(n=>n.validate(t,e,r));return new Promise((i,o)=>{Promise.all(n).then(()=>{i({to:t,from:e,next:r})},t=>{o(t)})})}get items(){return this.$items}set items(t){t instanceof Array||(t=[t]),this.$items=t.map(t=>u(t))}[Symbol.iterator](){return this.items.values()}}class f{constructor(t,e){if(t instanceof String&&(t={path:t}),!(t instanceof Object))throw Error("Middleware instances must be instantiated with a string or object.");this.middlewares=new l,this.callbacks={onValid:[],onError:[]};for(const[r,n]of Object.entries(t))n instanceof Function&&this.callbacks[r]?this.callbacks[r].push(n):this[r]instanceof Function?this[r](n):this[r]=n;t.middleware?this.middleware(t.middleware):t.meta&&t.meta.middleware&&this.middleware(t.meta.middleware),this.beforeEnter=(e,r,n)=>{this.middlewares.validate(e,r,n).then(()=>{this.emit("onValid",e,r,n),t.beforeEnter&&t.beforeEnter instanceof Function?t.beforeEnter(e,r,n):n()},t=>{this.emit("onError",t)})}}set callbacks(t){this.$callbacks=t}get callbacks(){return this.$callbacks}set middlewares(t){t instanceof l||(t=new l(t)),this.$middlewares=t}get middlewares(){return this.$middlewares}middleware(t){return t instanceof Array||(t=[t]),t.forEach(t=>this.middlewares.add(t)),this}onValid(t){return this.callback("onValid",t)}onError(t){return this.callback("onError",t)}emit(t,...e){this.callbacks[t]&&this.callbacks[t].forEach(t=>t(...e))}callback(t,e){if(!(e instanceof Function))throw Error("Callback must be an instance of a Function.");return this.callbacks[t]=e,this}}function h(t,e){return new f(t,e)}r.d(e,"route",function(){return h}),r.d(e,"global",function(){return o}),r.d(e,"register",function(){return s}),r.d(e,"instance",function(){return u}),r.d(e,"Middleware",function(){return d}),r.d(e,"MiddlewareRoute",function(){return f}),r.d(e,"MiddlewareIterator",function(){return l})}})["default"]});
//# sourceMappingURL=VueMiddlewares.umd.min.js.map